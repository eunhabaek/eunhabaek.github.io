S3에서 리액트 무중단 배포
===============

local에서 aws cli로 배포 시
---------------------

*   로컬 컴퓨터에서 S3로 직접 배포 가능

*   빌드된 코드만 업로드 하면 됨

*   빠르다

*   but, 협업 불가능

*   혼자 작업 시 좋은 방법

Git hub 등 소스 코드 버전 관리 사이트에서 action 이용 배포
----------------------------------------

*   협업이 쉬움

*   빌드되기 전 코드를 전송해야 함

*   빌드를 직접 github에서 해야 하므로 배포 속도가 느림

실습
--

### 1\. React project 생성

### 2\. Frontend app 배포 위한 S3 버킷 생성

*   ACL 활성화

*   퍼블릭 액세스 허용

*   정적 웹사이트 호스팅 활성화

### 3\. 외부에서 접근 가능하도록 설정

*   외부에 ajax 요청 할 시 해당 버킷에 CORS 설정이 되어 있어야 함

*   퍼블릭 엑세스 차단을 해제

*   권한 > 버킷 정책 수정
    
        {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Sid": "PublicListGet",
                    "Effect": "Allow",
                    "Principal": "*",
                    "Action": [
                        "s3:List*",
                        "s3:Get*",
                        "s3:Put*",
                        "s3:Delete*"
                    ],
                    "Resource": [
                        "arn:aws:s3:::eunhabucket2",
                        "arn:aws:s3:::eunhabucket2/*"
                    ]
                }
            ]
        }
    

### 4\. HTTP 서비스 가능하도록 설정 - HTTP endpoint 생성

[http://eunhabucket2.s3-website-ap-northeast-1.amazonaws.com](http://eunhabucket2.s3-website-ap-northeast-1.amazonaws.com/)

### 5\. Github 작업

*   github에 원하는 레포지토리 올리기

*   S3에 배포하기 위해 필요한 정보
    
    *   S3 버킷 명: [eunhabucket2](https://s3.console.aws.amazon.com/s3/buckets/eunhabucket2?region=us-east-1)
    
    *   access key, secret access key
        
        *   AWS Access Key ID : AKIAZ6BCJVVQBLVO3F5V
        
        *   AWS Secret Access Key \[None\]: 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
    
    *   region name: ap-northeast-1

### 6\. git action yaml 파일 작성

*   .github/workfows에 업로드
    
        name: CI/CD_AWS_S3
        
        on:
          push:
            branches:
              - main
        jobs:
          deploy:
            runs-on: ubuntu-latest
            steps:
              - name: 코드 체크아웃
                uses: actions/checkout@v3
              - name: AWS IAM 사용자 설정
                uses: aws-actions/configure-aws-credentials@v2
                with:
                  aws-access-key-id: AKIAZ6BCJVVQBLVO3F5V
                  aws-secret-access-key: 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
                  aws-region: ap-northeast-1
              - name: 리액트 빌드
                run: |
                  yarn install
                  yarn run build
              - name: S3 업로드
                run: aws s3 sync build/ s3://eunhabucket2 -- acl public-read
                env:
                  AWS-ACCESS-KEY-ID: AKIAZ6BCJVVQBLVO3F5V
                  AWS-SECRET-ACCESS-KEY: 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
    
    *   git에 push 진행
        
        [![](S3%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%86%E1%85%AE%E1%84%8C%E1%85%AE%E1%86%BC%E1%84%83%E1%85%A1%E1%86%AB%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20dbd8b370d63d4d7485da7d57bf605cb3/Untitled.png)](S3%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%86%E1%85%AE%E1%84%8C%E1%85%AE%E1%86%BC%E1%84%83%E1%85%A1%E1%86%AB%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20dbd8b370d63d4d7485da7d57bf605cb3/Untitled.png)
        

### 7\. Cloud Front 이용 CDN 설정 및 다른 도메인 연결하여 https 적용

local에서 aws cli로 배포 시
---------------------

*   로컬 컴퓨터에서 S3로 직접 배포 가능

*   빌드된 코드만 업로드 하면 됨

*   빠르다

*   but, 협업 불가능

*   혼자 작업 시 좋은 방법

Git hub 등 소스 코드 버전 관리 사이트에서 action 이용 배포
----------------------------------------

*   협업이 쉬움

*   빌드되기 전 코드를 전송해야 함

*   빌드를 직접 github에서 해야 하므로 배포 속도가 느림

실습
--

### 1\. React project 생성

### 2\. Frontend app 배포 위한 S3 버킷 생성

*   ACL 활성화

*   퍼블릭 액세스 허용

*   정적 웹사이트 호스팅 활성화

### 3\. 외부에서 접근 가능하도록 설정

*   외부에 ajax 요청 할 시 해당 버킷에 CORS 설정이 되어 있어야 함

*   퍼블릭 엑세스 차단을 해제

*   권한 > 버킷 정책 수정
    
        {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Sid": "PublicListGet",
                    "Effect": "Allow",
                    "Principal": "*",
                    "Action": [
                        "s3:List*",
                        "s3:Get*",
                        "s3:Put*",
                        "s3:Delete*"
                    ],
                    "Resource": [
                        "arn:aws:s3:::eunhabucket2",
                        "arn:aws:s3:::eunhabucket2/*"
                    ]
                }
            ]
        }
    

### 4\. HTTP 서비스 가능하도록 설정 - HTTP endpoint 생성

[http://eunhabucket2.s3-website-ap-northeast-1.amazonaws.com](http://eunhabucket2.s3-website-ap-northeast-1.amazonaws.com/)

### 5\. Github 작업

*   github에 원하는 레포지토리 올리기

*   S3에 배포하기 위해 필요한 정보
    
    *   S3 버킷 명: [eunhabucket2](https://s3.console.aws.amazon.com/s3/buckets/eunhabucket2?region=us-east-1)
    
    *   access key, secret access key
        
        *   AWS Access Key ID : AKIAZ6BCJVVQBLVO3F5V
        
        *   AWS Secret Access Key \[None\]: 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
    
    *   region name: ap-northeast-1

### 6\. git action yaml 파일 작성

*   .github/workfows에 업로드
    
        name: CI/CD_AWS_S3
        
        on:
          push:
            branches:
              - main
        jobs:
          deploy:
            runs-on: ubuntu-latest
            steps:
              - name: 코드 체크아웃
                uses: actions/checkout@v3
              - name: AWS IAM 사용자 설정
                uses: aws-actions/configure-aws-credentials@v2
                with:
                  aws-access-key-id: AKIAZ6BCJVVQBLVO3F5V
                  aws-secret-access-key: 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
                  aws-region: ap-northeast-1
              - name: 리액트 빌드
                run: |
                  yarn install
                  yarn run build
              - name: S3 업로드
                run: aws s3 sync build/ s3://eunhabucket2 -- acl public-read
                env:
                  AWS-ACCESS-KEY-ID: AKIAZ6BCJVVQBLVO3F5V
                  AWS-SECRET-ACCESS-KEY: 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
    
    *   git에 push 진행
        
        [![](S3%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%86%E1%85%AE%E1%84%8C%E1%85%AE%E1%86%BC%E1%84%83%E1%85%A1%E1%86%AB%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20dbd8b370d63d4d7485da7d57bf605cb3/Untitled.png)](S3%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%86%E1%85%AE%E1%84%8C%E1%85%AE%E1%86%BC%E1%84%83%E1%85%A1%E1%86%AB%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9%20dbd8b370d63d4d7485da7d57bf605cb3/Untitled.png)
        

### 7\. Cloud Front 이용 CDN 설정 및 다른 도메인 연결하여 https 적용