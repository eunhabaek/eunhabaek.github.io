---
title: "카프카 개요"

categories:
  - Kafka
last_modified_at: 2023-08-24
---

Kafka
-----

*   링크드인에서 파편화된 데이터 수집 및 분배 아키텍쳐 구현 위해 개발

*   데이터 생성 소스 앱과 데이터 최종 적재되는 앱을 별도로 개발

*   데이터 파편화가 발생

*   내부 데이터 흐름을 개선하기 위한 새로운 시스템

*   소스 앱과 저장 앱을 직접 연결하지 않음
    
    *   클라이언트 앱 ↔ API gateway ↔ 서버 앱
    
    *   사용자 ↔ 로드밸런서 ↔ 서비스하는 pod
    
    *   요청 ↔ [urls.py](http://urls.py) ↔ views.py

*   앱끼리 직접 연결하지 않고 한 곳 에서 처리 가능

*   큐에 데이터 보내는 것이 프로듀서, 큐에서 데이터 가져가는 게 컨슈머

*   하나의 데이터를 파티션이라고 하고, 파티션을 모은 것을 토픽이라고 함

*   카프카는 데이터 포맷 제한 없음
    *   자바로 만들어져 있음

*   실무에서는 카프카 3개 이상을 하나로 묶은 클러스터 단위로 구동

Data lake vs Datawarehouse vs Data mart
---------------------------------------

*   datawarehouse
    *   필요한 데이터만 모아놓은 것

*   data mart
    *   datawarehouse보다 작은 개념

*   data lake(데이터 수집, 가공 X)
    *   가공하지 않은 순수한 데이터의 모음

Kafka 장점
--------

*   높은 처리량

*   뛰어난 확장성: 클러스터의 개념으로 동작 (auto-scaling)

*   영속성

*   pyspark은 pandas와 비슷한 역할

*   고가용성: 하나의 클러스터로 만들어진 브로커는 모두 동일 데이터 복제해서 소유 (replica)

Lambda architecture
-------------------

![image](https://github.com/eunhabaek/eunhabaek.github.io/assets/67853963/06d14b21-9d44-4e10-9d5e-dd13c5f6b93b)


Kapa architecture
-----------------

![image](https://github.com/eunhabaek/eunhabaek.github.io/assets/67853963/211a66c2-8313-466b-b4db-2426d2001e84)


*   람다 아키텍쳐에서 배치 레이어를 제거

*   배치 레이어는 실시간 처리하지 않기 때문에 제거

*   일정한 주기 배치 데이터도 스트림으로 바로 처리

*   모든 데이터를 로그로 바라봄

Data Lake
---------

*   레거시는 end to end 형태로 수집 및 저장

*   데이터 수집 부분을 배치 레이어와 스피드레이어로 구성하고 서비스하는 부분을 서빙 레이어로 구성

*   배치 레이어는 일정한 주기 이용 데이터 모아서 처리, 스피드 레이어는 실시간 데이터 처리 레이어

Streaming Data Lake
-------------------

*   기존 방식에서는 서빙 레이어 (S3, hadoop) 등에 저장해서 사용

*   최근에는 서빙 레이어를 제거하는데 이미 분석된 데이터를 저장하는 방식

*   서빙레이어 필요없음

*   레거시
    *   데이터 수집 앱 → kafka → 데이터 분석 및 사용 앱

*   최근
    *   데이터 수집 앱/데이터 분석 및 사용 앱 ↔ kafka

*   비용 많이 발생
    *   따라서 카파를 많이 사용

Zookeeper
---------

*   카프카의 브로커를 관리하는 앱

Confluent
---------

*   kafka의 데이터 DB에 관계 없이 sql을 이용해서 조회할 수 있도록 해줌
