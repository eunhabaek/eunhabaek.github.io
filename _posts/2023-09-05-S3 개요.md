S3 개요
=====

AWS backup
----------

*   온프레미스 환경 사내 데이터를 aws 백업

*   aws에 구축한 사이트 시스템 백업

*   용량 큰 이미지 파일, 데이터베이스, 각 서버 로그, 일반 파일 등이 백업 대상

*   로그 파일과 데이터베이스는 장기간 보관

*   비용 절감하며 운영에 손이 많이 가지 않게 진행

Infrastructure
--------------

*   온프레미스에 스토리지 게이트 웨이 사용하여 S3에 자동 백업

*   S3와 글레이셔 이용 수명 주기 관리
    *   S3로 백업하고 온라인 보관 기간 넘은 파일은 글레이셔에 아카이브

*   이미지 파일과 데이터베이스는 스크립트 이용 백업

On-premise backup
-----------------

*   일반적 방법
    
    *   object storage service인 S3을 cli 이용하는 패턴
    
    *   관리자가 있을 경우 사용하는 방법

*   가상서버인 EC2와 가상 스토리지 EBS로 구축한 백업용 서버에 데이터를 동기화
    
    *   S3보다 비용이 증가하지만 백업을 유연하게 할 수 있음
    
    *   EC2에 앱을 만들어 실행하는 경우 온라인 백업 자유로움
    
    *   유저가 여러명일 경우 사용

*   AWS 스토리지 게이트웨이 이용
    
    *   온프레미스 환경과 AWS를 직접 연결
    
    *   가장 쉬우나 비용이 가장 많이 소모

*   최근에는 높은 추상화
    *   개발자는 개발에만 신경쓰고 나머지 작업은 이미 구성된 SW 이용 방식

S3 backup
---------

*   AWS CLI 이용 백업

*   언어별 API 이용 백업

*   cron이나 작업 스케쥴러 제공

*   S3는 인바운드 전송은 무료이고 온프레미스는 유료

*   라이프사이클 설정 가능, 일정 기간 이후 삭제 가능

*   서버사이드 암호화 제공
    
    *   전송시에는 원본
    
    *   파일 저장 될 때 암호화 됨
    
    *   꺼낼 때 복호화 수행

EC2 backup
----------

*   EBS 스토리지 이용

*   별도 앱 제작해서 활용 가능

*   S3에 비해 자유로움

*   S3보다는 비용 증가

AWS Storage gateway backup
--------------------------

3rd party backup
----------------

*   MSP나 DSP 제품 이용

*   CSP는 인프라 제공 기업

Backup file
-----------

*   AWS는 아카이브 스토리지 서비스인 글레이셔 제공

*   자주 사용 X 오래 보관해야 하는 데이터 보관에 적합

*   S3에 비해 1/5~1/10 정도이며 엑세스에 시간 소요

*   S3에서 일정 기간 지나면 글레이셔로 이동하도록 설정 가능

AWS와 on-premise 전용선 연결
----------------------

*   인터넷 VPN 이용

AWS로 file server 구축
-------------------

*   파일을 공유하거나 콘텐츠 관리 기능 요구되는 경우 사용

*   직접 파일 서버를 구축하고자 하면 비용 발생

*   관리형 파일 서버를 이용하고자 하는 경우 EFS라는 서비스 이용 권장
    
    *   S3는 HTTP나 HTTPS 서비스 이용해서 접근 가능
    
    *   네트워크 프로토콜 NFS 이용하는 것보다 S3는 느림

*   워크독스 이용 파일 공유도 가능

S3
--

*   Simple Storage Service는 인터넷 스토리지 서비스

*   용량에 관계없이 파일 저장 가능, 웹에서 파일 접근 가능

*   안정성이 뛰어나 가용성 높음

*   무제한 확장 가능

*   정적 웹 호스팅 가능 (html, css, js로만 구성된 웹 앱)

*   S3 자체가 수천대 이상의 성능 좋은 웹 서버로 구성되어 있어 자동 auto scailing이나 load balancing 신경쓰지 않아도 됨
    *   docker만들 시 nginx를 앞에 달아서 load balancing을 하거나 kubernetes의 replicaset을 이용해 횡적 확장 할 필요 없음

*   동적 웹 처리 부분과 정적 웹 서비스 부분이 있다면 이를 분리하여 구현하고 동적 웹 처리부분은 컨테이너나 EC2 이용해서 배포하고 정적 웹 서비스 부분을 이용하는 것이 가능

S3 개념
-----

*   객체
    
    *   S3에 저장되는 단위
    
    *   파일과 메타데이터로 구성
    
    *   key가 객체의 이름이고 value가 실제 데이터

*   bucket
    
    *   S3에서 만들 수 있는 최상위 디렉토리
    
    *   리전별로 생성되며 계정별 100개까지 생성 가능
    
    *   버킷 안에 객체가 저장되고 디렉토리 생성 가능
    
    *   저장 가능한 객체의 개수와 저장 가능한 용량 무제한
    
    *   URL로 접근 가능

*   내구성
    *   데이터 유실되지 않는 성질

*   가용성
    *   언제나 정상적으로 이용 가능한 상태

*   S3 서비스는 내구성 기준으로 2가지 storage 제공
    
    *   복제본 개수를 다르게 하여 내구성 유지
    
    *   요금 개념은 저장 용량과 데이터 다운로드 양, HTTP 요청 개수로 책정
    